"use strict";(self.webpackChunksrcful_documentation=self.webpackChunksrcful_documentation||[]).push([[3928],{8453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>o});var s=i(6540);const t={},r=s.createContext(t);function a(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),s.createElement(r.Provider,{value:n},e.children)}},9241:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"developer/auth","title":"Authentication & Permissioning","description":"\u201cConnect with Sourceful\u201d is our OAuth\u2011style permissioning model. Users approve explicit scopes, and client apps receive a short\u2011lived, signed token to call Sourceful APIs according to granted permissions. Bifrost is the bridge service that facilitates this delegated authentication flow.","source":"@site/docs/developer/auth.md","sourceDirName":"developer","slug":"/developer/auth","permalink":"/developer/auth","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"slug":"/developer/auth","pagination_prev":null},"sidebar":"docs","next":{"title":"Price API Developer Guide","permalink":"/developer/price-api"}}');var t=i(4848),r=i(8453);const a={sidebar_position:4,slug:"/developer/auth",pagination_prev:null},o="Authentication & Permissioning",l={},c=[{value:"Bifrost Authentication Service",id:"bifrost-authentication-service",level:2},{value:"Key Features",id:"key-features",level:2},{value:"Authentication Flow",id:"authentication-flow",level:2},{value:"Session Lifecycle",id:"session-lifecycle",level:2},{value:"JWT Delegate Token Structure",id:"jwt-delegate-token-structure",level:2},{value:"Consent Scopes (Permissions)",id:"consent-scopes-permissions",level:3},{value:"Security Considerations",id:"security-considerations",level:2},{value:"API Endpoints",id:"api-endpoints",level:2},{value:"Create Session",id:"create-session",level:3},{value:"Get Session",id:"get-session",level:3},{value:"Delete Session",id:"delete-session",level:3},{value:"Implementation Example",id:"implementation-example",level:2},{value:"API Documentation",id:"api-documentation",level:2},{value:"Token Renewal",id:"token-renewal",level:2},{value:"JWT Renew Token Structure",id:"jwt-renew-token-structure",level:3},{value:"JWT Renew Certificate Structure",id:"jwt-renew-certificate-structure",level:3},{value:"Validation",id:"validation",level:3}];function d(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"authentication--permissioning",children:"Authentication & Permissioning"})}),"\n",(0,t.jsx)(n.p,{children:"\u201cConnect with Sourceful\u201d is our OAuth\u2011style permissioning model. Users approve explicit scopes, and client apps receive a short\u2011lived, signed token to call Sourceful APIs according to granted permissions. Bifrost is the bridge service that facilitates this delegated authentication flow."}),"\n",(0,t.jsx)(n.h2,{id:"bifrost-authentication-service",children:"Bifrost Authentication Service"}),"\n",(0,t.jsx)(n.p,{children:"Bifrost is an authentication service that enables secure communication between external applications and the Sourceful Energy App (SEA). It serves as a bridge that facilitates safe authentication without requiring users to install external wallets on multiple devices. In short, Bifrost exchanges a delegation token that grants the token owner permission to access some of the user\u2019s resources."}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Security by Design"}),": Bifrost only handles public keys, never private keys. All private keys remain securely within either the SEA or the external application, ensuring that sensitive cryptographic material is never exposed to the bridge service."]}),"\n"]}),"\n",(0,t.jsx)(n.mermaid,{value:"graph LR\n    A[External Application] <--\x3e B[Bifrost Service]\n    B <--\x3e C[Sourceful Energy App]"}),"\n",(0,t.jsx)(n.h2,{id:"key-features",children:"Key Features"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Delegated Authentication"}),": Allows third-party applications to authenticate via SEA to access the Sourceful Energy API as the authenticated user"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"No External Wallet Requirements"}),": Users don't need to install external wallets on all devices"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Secure Session Management"}),": Short-lived sessions with explicit user approval"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"JWT-based Authentication"}),": Signed tokens for authenticated API access"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Zero Private Key Exposure"}),": Only public keys are transmitted through Bifrost, with private keys remaining securely within their respective applications"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"authentication-flow",children:"Authentication Flow"}),"\n",(0,t.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant EA as External Application\n    participant BF as Bifrost\n    participant SEA as Sourceful Energy App\n    participant API as Sourceful Energy API\n    \n    Note over EA: Generate private key<br/>(remains in EA)\n    EA->>BF: POST /api/auth with delegatedKey (public key only) and attributes object\n    BF->>EA: Return session_id and session_url\n    \n    Note over EA: Generate deep link or QR code\n    EA->>SEA: Deep link with session_id\n    \n    Note over SEA: User approval request\n    \n    alt User approves\n        Note over SEA: Sign JWT with user's<br/>private key (remains in SEA)\n        SEA->>BF: POST /api/auth/{session_id} with JWT token\n        BF->>SEA: Return success response\n        EA->>BF: polls GET /api/auth/{session_id}\n        BF->>EA: Return JWT token\n        \n        Note over EA: Use JWT for authentication\n        EA->>API: API requests with JWT\n        API->>EA: Return requested data\n    else User rejects or timeout (3 min)\n        SEA->>EA: Authentication failed\n    end"}),"\n",(0,t.jsx)(n.h2,{id:"session-lifecycle",children:"Session Lifecycle"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Session Creation"}),": External application generates a private key and sends its public key and an attributes object to Bifrost"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Session Validity"}),": Sessions are valid for a maximum of 3 minutes"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"User Approval"}),": During this time, the user must approve the session in SEA"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Token Issuance"}),": Upon approval, a JWT signed by the user is returned to the external application"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"API Access"}),": The JWT can then be used for authentication with the Sourceful Energy API"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"jwt-delegate-token-structure",children:"JWT Delegate Token Structure"}),"\n",(0,t.jsx)(n.p,{children:"JWT tokens issued by Bifrost follow this structure:"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Header"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "alg": "Ed25519",\n  "typ": "JWT"\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Payload"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "created": "2025-04-28T08:50:41Z",\n  "expiration": "2025-04-28T20:50:41Z",\n  "issuer": "Bygcy876b3bsjMvvhZxghvs3EyR5y6a7vpvAp5D62n2w",\n  "delegatedKey": "AWyXK19172kDydraqvqo1sAHpEBmPC81yxWsGFnShQbc"\n  "attributes": {"nonce":"abc123", "name":"Test Application", "permissions":{...}}\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"Where:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"issuer"}),": The user's public key whose corresponding private key signs the JWT in SEA in base58 format"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"delegatedKey"}),": The public key of the external application whose generated private key can be used to sign messages in base58 format"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"attributes"}),": Additional attributes that describe the token, currently ",(0,t.jsx)(n.code,{children:"name"}),", ",(0,t.jsx)(n.code,{children:"nonce"}),", and ",(0,t.jsx)(n.code,{children:"permissions"})," are supporte by the SEA and API Backend. Permissions are of particular interest and are documented in its own section, but basically describe what the token is allowed to do with defined resources. The ",(0,t.jsx)(n.code,{children:"nonce"})," attribute is added by Bifrost automatically and must NOT be changed in the token exchange."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"In an application it makes sense to show the issuer public key so the user understands what wallet is logged in, and make it clear this is delegated\u2011token based authentication. It does not make sense to show the delegatedKey as this is only used internally in the application and JWT token. The expiration time can be changed; by default the time\u2011to\u2011live is 12h."}),"\n",(0,t.jsx)(n.h3,{id:"consent-scopes-permissions",children:"Consent Scopes (Permissions)"}),"\n",(0,t.jsxs)(n.p,{children:["Permissions are expressed as scopes and optional resource selectors in the JWT ",(0,t.jsx)(n.code,{children:"attributes.permissions"})," object. Scopes follow an ",(0,t.jsx)(n.code,{children:"action:resource"})," pattern and are validated server\u2011side."]}),"\n",(0,t.jsx)(n.p,{children:"Examples (illustrative):"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"read:meter"})," \u2014 read near\u2011real\u2011time and historical meter telemetry for user\u2011owned sites"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"read:tariff"})," \u2014 read tariff and price intelligence for authorized locations"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"read:site"})," \u2014 read site metadata and connected assets"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"write:control:der"})," \u2014 request control actions on authorized DERs (where enabled)"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Example ",(0,t.jsx)(n.code,{children:"attributes"})," payload embedded in the JWT:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "name": "Acme Optimizer",\n  "nonce": "auto-generated-by-bifrost",\n  "permissions": {\n    "scopes": ["read:meter", "read:tariff", "read:site"],\n    "resources": {\n      "sites": ["site_123"],\n      "meters": ["meter_abc"]\n    },\n    "expires_in": 43200\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"Notes:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Scopes are least\u2011privilege; request only what you need."}),"\n",(0,t.jsx)(n.li,{children:"Resources narrow access to specific sites/meters/assets where applicable."}),"\n",(0,t.jsx)(n.li,{children:"Tokens are short\u2011lived; use the renewal mechanism below only when the token was originally granted as renewable."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,t.jsx)(n.mermaid,{value:"flowchart TD\n    A[Security Measures] --\x3e B[3-minute Session Timeout]\n    A --\x3e C[JWT with Limited TTL]\n    A --\x3e D[User Explicit Approval]\n    A --\x3e E[Transfer Gateway Restriction]\n    A --\x3e J[Private Key Isolation]\n    \n    B --\x3e F[Reduces Attack Window]\n    C --\x3e G[Limits Compromise Duration]\n    D --\x3e H[Prevents Silent Attacks]\n    E --\x3e I[Protects Critical Operations]\n    J --\x3e K[Prevents Key Compromise]"}),"\n",(0,t.jsx)(n.p,{children:"While JWT token authentication provides improved user experience and security compared to exporting private keys, it still presents potential phishing risks:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"An attacker could generate a session and send a deep link to a user"}),"\n",(0,t.jsx)(n.li,{children:"If the user approves the authentication request, the attacker could gain access"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"To mitigate these risks, Bifrost implements:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Short Session Timeouts"}),": Sessions expire after 3 minutes"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Limited JWT Validity"}),": Tokens have a specified time-to-live"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Transfer Gateway Protection"}),": The transfer gateway mutation does not accept JWT authentication"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Private Key Separation"}),": Private keys never leave their origin applications:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"External application's private key remains in the external application"}),"\n",(0,t.jsx)(n.li,{children:"User's private key remains in the SEA"}),"\n",(0,t.jsx)(n.li,{children:"Bifrost only handles public keys and signed tokens"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"No tokens saved"}),": Bifrost only saves metadata regarding the delegate token, not the token itself. It is the responsibility of the external application to maintain its delegate token and private key."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"api-endpoints",children:"API Endpoints"}),"\n",(0,t.jsx)(n.h3,{id:"create-session",children:"Create Session"}),"\n",(0,t.jsx)(n.p,{children:"Creates a new authentication session for key exchange between an external application and SEA."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"URL"}),": ",(0,t.jsx)(n.code,{children:"/api/auth"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Method"}),": ",(0,t.jsx)(n.code,{children:"POST"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Request Body"}),":","\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "delegatedKey": "5LubpwhZzwkKW49a2b5GwfFJdep1xtMDsuVeMGeBvJfx"\n  "attributes": {...}\n}\n'})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Response"}),":","\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "session_url": "https://example.com/auth/session/abcd1234",\n  "session_id": "abcd1234"\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"get-session",children:"Get Session"}),"\n",(0,t.jsx)(n.p,{children:"Retrieves the current state of a session."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"URL"}),": ",(0,t.jsx)(n.code,{children:"/api/auth/{session_id}"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Method"}),": ",(0,t.jsx)(n.code,{children:"GET"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Response"}),":","\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "delegatedKey": "5LubpwhZzwkKW49a2b5GwfFJdep1xtMDsuVeMGeBvJfx",\n  "expiresAt": 1619654400,\n  "token": "eyJhbGciOiJFZDI1NTE5IiwidHlwIjoiSldUIn0..."\n  "attributes": {...}\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"delete-session",children:"Delete Session"}),"\n",(0,t.jsx)(n.p,{children:"Explicitly deletes a session before it expires."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"URL"}),": ",(0,t.jsx)(n.code,{children:"/api/auth/{session_id}"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Method"}),": ",(0,t.jsx)(n.code,{children:"DELETE"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Response"}),":","\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "status": "success"\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"implementation-example",children:"Implementation Example"}),"\n",(0,t.jsx)(n.mermaid,{value:'sequenceDiagram\n    participant EA as External App\n    participant BF as Bifrost\n    participant SEA as Sourceful Energy App\n    \n    EA->>EA: Generate key pair<br/>(private key stays in EA)\n    EA->>BF: POST /api/auth<br/>{ delegatedKey: "public_key", attributes: {name: "Test Application"} }\n    BF->>EA: { session_id: "xyz123", session_url: "..." }\n    \n    EA->>EA: Generate QR code/deep link\n    \n    Note over SEA: User scans QR/clicks link\n    SEA->>BF: GET /api/auth/xyz123\n    BF->>SEA: { delegatedKey: "public_key", expiresAt: 12345 }\n    \n    Note over SEA: User approves auth\n    SEA->>SEA: Sign JWT with user\'s private key<br/>(private key never leaves SEA)\n    SEA->>BF: POST /api/auth/xyz123<br/>{ token: "signed_jwt" }\n    BF->>SEA: { status: "success" }\n    \n    EA->>BF: GET /api/auth/xyz123\n    BF->>EA: { delegatedKey: "public_key", token: "signed_jwt", expiresAt: 12345 }\n    \n    Note over EA: Store JWT for API auth'}),"\n",(0,t.jsx)(n.h2,{id:"api-documentation",children:"API Documentation"}),"\n",(0,t.jsx)(n.p,{children:"The full OpenAPI documentation is available at:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"https://bifrost.srcful.dev/docs\n"})}),"\n",(0,t.jsx)(n.p,{children:"The Bifrost endpoints requires authentication in the form of a token. See the Bifrost documentation above for details."}),"\n",(0,t.jsx)(n.h2,{id:"token-renewal",children:"Token Renewal"}),"\n",(0,t.jsx)(n.p,{children:"In general, delegate tokens are short\u2011lived and cannot be renewed without user involvement (the issuer must re\u2011sign). This creates UX friction for long\u2011running automations."}),"\n",(0,t.jsxs)(n.p,{children:["A delegate token can be explicitly granted as renewable (",(0,t.jsx)(n.code,{children:'attributes.permissions.renew": true'}),"). If so, the application may request a renewal certificate from Bifrost to mint a new delegate token without additional user interaction. This renew token has the following structure:"]}),"\n",(0,t.jsx)(n.h3,{id:"jwt-renew-token-structure",children:"JWT Renew Token Structure"}),"\n",(0,t.jsx)(n.p,{children:"This is a token that is built by the client application and basically consists of a renew certificate token."}),"\n",(0,t.jsx)(n.p,{children:"JWT renew tokens follow this structure:"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Header"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "alg": "Ed25519",\n  "typ": "JWT"\n  "tkt": "renew"\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Payload"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "cert": "the renew cert token in base64 (signed by bifrost)"\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"Where:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"cert"}),": The certificate token signed by bifrost. Importantly it contains new created and expiration times as well as the nonce of the original delegate token and a bifrost key id."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Note the subtype (",(0,t.jsx)(n.code,{children:"styp"}),") in the header is set to ",(0,t.jsx)(n.code,{children:"renew"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"A client application will periodically ask Bifrost for a new certificate token and build its own renew token based on this. This can then be used in the backend API calls according to the permissions of the original token. If the original token is revoked by the user, bifrost will not issue a new certificate."}),"\n",(0,t.jsx)(n.h3,{id:"jwt-renew-certificate-structure",children:"JWT Renew Certificate Structure"}),"\n",(0,t.jsxs)(n.p,{children:["Bifrost creates the renew certificate and signs it with its internal private key.\n",(0,t.jsx)(n.strong,{children:"Header"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "alg": "Ed25519",\n  "typ": "JWT"\n  "tkt": "renewcrt"\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Payload"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "iss": "7f3a9b2e",\n  "created": "2025-04-28T08:50:41Z",\n  "expiration": "2025-04-28T09:10:41Z",\n  "dtoken": "The original delegate token signed by the issuer in base64"\n  "nonce": "b88b45e1-fc5a-4cb1-b689-0d8f7f4cba04"\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"Where:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"iss"}),": The id of the public key in Bifrost"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"dToken"}),": The original delegate token signed by the issuer. Importantly this token contains the permissions, renewable and delegateKey"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"validation",children:"Validation"}),"\n",(0,t.jsx)(n.p,{children:"Validation of a renew token follows the steps:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Extract the certificate tokens."}),"\n",(0,t.jsx)(n.li,{children:"Ensure valid signatures the certificate token (fetch the public key from Bifrost using the keyId in the certificate token)."}),"\n",(0,t.jsx)(n.li,{children:"Check expiration of the certificate token"}),"\n",(0,t.jsx)(n.li,{children:"Extract the delegate token (dtoken attribute)"}),"\n",(0,t.jsx)(n.li,{children:"Ensure valid signature of the dtoken (issuer attribute public key)"}),"\n",(0,t.jsx)(n.li,{children:"Ensure valid signature of renew token (use delegateKey from delegate token)"}),"\n",(0,t.jsx)(n.li,{children:"The renew token is now valid and continued validation of message and permissions can be done."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);