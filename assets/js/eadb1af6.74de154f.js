"use strict";(self.webpackChunksrcful_documentation=self.webpackChunksrcful_documentation||[]).push([[6109],{3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>g});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},d=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},u="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),u=p(a),m=r,g=u["".concat(s,".").concat(m)]||u[m]||c[m]||i;return a?n.createElement(g,l(l({ref:t},d),{},{components:a})):n.createElement(g,l({ref:t},d))}));function g(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,l=new Array(i);l[0]=m;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[u]="string"==typeof e?e:r,l[1]=o;for(var p=2;p<i;p++)l[p]=a[p];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},7139:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>c,frontMatter:()=>i,metadata:()=>o,toc:()=>p});var n=a(7462),r=(a(7294),a(3905));const i={sidebar_position:1,slug:"/developer/api/docs",pagination_prev:null},l="GraphQL API",o={unversionedId:"developer/API/api-docs",id:"developer/API/api-docs",title:"GraphQL API",description:"Overview",source:"@site/docs/developer/API/api-docs.md",sourceDirName:"developer/API",slug:"/developer/api/docs",permalink:"/developer/api/docs",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,slug:"/developer/api/docs",pagination_prev:null},sidebar:"tutorialSidebar",next:{title:"Authentication",permalink:"/developer/api/authentication"}},s={},p=[{value:"Overview",id:"overview",level:2},{value:"Quick Start",id:"quick-start",level:2},{value:"Keys and Identifiers",id:"keys-and-identifiers",level:2},{value:"The Gateway Concept",id:"the-gateway-concept",level:3},{value:"Key Identifier Types",id:"key-identifier-types",level:3},{value:"Understanding the Relationship Between IDs",id:"understanding-the-relationship-between-ids",level:4},{value:"API Playground &amp; Gateway Explorer",id:"api-playground--gateway-explorer",level:3},{value:"Available Data Sources",id:"available-data-sources",level:2},{value:"Example Queries",id:"example-queries",level:2},{value:"List gateway DERS",id:"list-gateway-ders",level:3},{value:"Real-time Solar Production for a gateway",id:"real-time-solar-production-for-a-gateway",level:3},{value:"Real-time Solar Production for a solar DER",id:"real-time-solar-production-for-a-solar-der",level:3},{value:"Battery Status with Historical Data",id:"battery-status-with-historical-data",level:3},{value:"Grid Consumption &amp; Export",id:"grid-consumption--export",level:3},{value:"Time-Series Data Options",id:"time-series-data-options",level:2},{value:"Time Ranges",id:"time-ranges",level:3},{value:"Resolution Options",id:"resolution-options",level:3},{value:"Example Python Code",id:"example-python-code",level:2}],d={toc:p},u="wrapper";function c(e){let{components:t,...a}=e;return(0,r.kt)(u,(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"graphql-api"},"GraphQL API"),(0,r.kt)("h2",{id:"overview"},"Overview"),(0,r.kt)("p",null,"The Sourceful GraphQL API provides access to real-time and historical data from distributed energy resources (DERs). You can query solar production, battery storage, and energy consumption data to build powerful monitoring and analytics applications."),(0,r.kt)("h2",{id:"quick-start"},"Quick Start"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'# Basic query example\ncurl -X POST \\\n  -H "Content-Type: application/json" \\\n  -d \'{"query": "{ derData { solar(gwId: \\"your-gateway-id\\") { latest { ts power } } } }"}\' \\\n  https://api.srcful.dev\n')),(0,r.kt)("h2",{id:"keys-and-identifiers"},"Keys and Identifiers"),(0,r.kt)("p",null,"The GraphQL API uses several different identifiers to access data from distributed energy resources (DERs). Understanding these identifiers is crucial for effectively querying the API and retrieving the correct data."),(0,r.kt)("h3",{id:"the-gateway-concept"},"The Gateway Concept"),(0,r.kt)("p",null,"In the Sourceful ecosystem, all data access is managed through the concept of gateways. A gateway is any device or service that collects and transmits data from energy resources to the Sourceful platform."),(0,r.kt)("h3",{id:"key-identifier-types"},"Key Identifier Types"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Identifier"),(0,r.kt)("th",{parentName:"tr",align:null},"Format"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"),(0,r.kt)("th",{parentName:"tr",align:null},"Used In"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Gateway ID (",(0,r.kt)("inlineCode",{parentName:"td"},"gwId"),")"),(0,r.kt)("td",{parentName:"tr",align:null},'String (e.g., "012307e4843d412cee")'),(0,r.kt)("td",{parentName:"tr",align:null},"Unique identifier for a device"),(0,r.kt)("td",{parentName:"tr",align:null},"Querys where the full context of the device/gateway is used")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"DER Serial Number (",(0,r.kt)("inlineCode",{parentName:"td"},"sn"),")"),(0,r.kt)("td",{parentName:"tr",align:null},'String (e.g., "pv-JgpMp...JhRP")'),(0,r.kt)("td",{parentName:"tr",align:null},"Hashed/encoded identifier for a specific DER, have a prefix in the start (e.g., em-, pv-) that shows the type of DER it represents"),(0,r.kt)("td",{parentName:"tr",align:null},"Used to query data from a specific device in the network")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Raw Serial Number (",(0,r.kt)("inlineCode",{parentName:"td"},"rawSn"),")"),(0,r.kt)("td",{parentName:"tr",align:null},"String"),(0,r.kt)("td",{parentName:"tr",align:null},"Actual serial number of the physical device (only available via authentication)"),(0,r.kt)("td",{parentName:"tr",align:null},"Limited use")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Device Reference (",(0,r.kt)("inlineCode",{parentName:"td"},"devRef"),")"),(0,r.kt)("td",{parentName:"tr",align:null},"String"),(0,r.kt)("td",{parentName:"tr",align:null},"Reference to connect multiple DERs to the same physical device"),(0,r.kt)("td",{parentName:"tr",align:null},"Used to know the physical connection between DERs")))),(0,r.kt)("h4",{id:"understanding-the-relationship-between-ids"},"Understanding the Relationship Between IDs"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"A Device/Gateway (gwId) can have multiple DERs connected to it"),(0,r.kt)("li",{parentName:"ol"},"Each DER has a unique Serial Number (sn)"),(0,r.kt)("li",{parentName:"ol"},"Multiple DERs may reference the same physical device via devRef"),(0,r.kt)("li",{parentName:"ol"},"The rawSn is the actual hardware serial number (only available to authenticated users)")),(0,r.kt)("h3",{id:"api-playground--gateway-explorer"},"API Playground & Gateway Explorer"),(0,r.kt)("p",null,"Want to experiment first? Visit our interactive ",(0,r.kt)("a",{parentName:"p",href:"https://api.srcful.dev/playground"},"API Playground")," to build queries, explore the schema, and see real-time results."),(0,r.kt)("p",null,"Need gateway IDs to use in your queries? Check out the ",(0,r.kt)("a",{parentName:"p",href:"https://explorer.sourceful.energy"},"Sourceful Explorer")," to find active gateways and their IDs for testing."),(0,r.kt)("h2",{id:"available-data-sources"},"Available Data Sources"),(0,r.kt)("p",null,"Our API gives you access to multiple energy data sources through a unified interface:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Data Source"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"),(0,r.kt)("th",{parentName:"tr",align:null},"Key Metrics"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Solar"),(0,r.kt)("td",{parentName:"tr",align:null},"Solar panel production"),(0,r.kt)("td",{parentName:"tr",align:null},"Current power (kW), Daily totals (kWh)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Battery"),(0,r.kt)("td",{parentName:"tr",align:null},"Battery storage systems"),(0,r.kt)("td",{parentName:"tr",align:null},"State of charge (%), Power flow (kW)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Energy Meter"),(0,r.kt)("td",{parentName:"tr",align:null},"Grid tie consumption/export"),(0,r.kt)("td",{parentName:"tr",align:null},"Consumption (kW), Delivery (kW), Phase data")))),(0,r.kt)("p",null,"In general, data can be queried on a per gateway or specific DER basis. Use the ",(0,r.kt)("a",{parentName:"p",href:"https://api.srcful.dev/playground"},"API Playground")," for the most recent documentation and queries."),(0,r.kt)("h2",{id:"example-queries"},"Example Queries"),(0,r.kt)("h3",{id:"list-gateway-ders"},"List gateway DERS"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-graphql"},'{\n  gateway {\n    gateway(id: "your-gateway-id") {\n      ders {\n        type\n        sn\n      }\n    }\n  }\n}\n')),(0,r.kt)("h3",{id:"real-time-solar-production-for-a-gateway"},"Real-time Solar Production for a gateway"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-graphql"},'{\n  derData {\n    solar(gwId: "your-gateway-id") {\n      latest {\n        ts\n        power  # Current power in kW\n      }\n      today   # Total generation today in kWh\n    }\n  }\n}\n')),(0,r.kt)("h3",{id:"real-time-solar-production-for-a-solar-der"},"Real-time Solar Production for a solar DER"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-graphql"},'{\n  derData {\n    solar(sn: "your-der-serial-number") {\n      latest {\n        ts\n        power  # Current power in kW\n      }\n      today   # Total generation today in kWh\n    }\n  }\n}\n')),(0,r.kt)("h3",{id:"battery-status-with-historical-data"},"Battery Status with Historical Data"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-graphql"},'{\n  derData {\n    battery(gwId: "your-gateway-id") {\n      latest {\n        ts\n        power  # Positive = charging, Negative = discharging\n        soc    # State of charge percentage\n      }\n      historical(\n       start: "2025-04-01T00:00:00Z",\n        stop: "2025-05-01T23:59:59Z",\n        resolution: "15m"\n      ) {\n        ts\n        power\n        soc\n      }\n    }\n  }\n}\n')),(0,r.kt)("h3",{id:"grid-consumption--export"},"Grid Consumption & Export"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-graphql"},'{\n  derData {\n    energyMeter(gwId: "your-gateway-id") {\n      latest {\n        ts\n        consumption  # Grid power consumed (kW)\n        delivery     # Power exported to grid (kW)\n        consumptionL1\n        consumptionL2\n        consumptionL3\n      }\n      daily(start: "2025-04-01", stop: "2025-05-01") {\n        ts\n        consumption\n        delivery\n      }\n    }\n  }\n}\n')),(0,r.kt)("h2",{id:"time-series-data-options"},"Time-Series Data Options"),(0,r.kt)("p",null,"Control how you retrieve historical data with these flexible parameters:"),(0,r.kt)("h3",{id:"time-ranges"},"Time Ranges"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Specify precise start/stop times using ISO-8601 format"),(0,r.kt)("li",{parentName:"ul"},"Custom date ranges for daily aggregations")),(0,r.kt)("h3",{id:"resolution-options"},"Resolution Options"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"resolution")," parameter accepts these formats:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},'"15s"')," - 15-second intervals"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},'"5m"')," - 5-minute intervals "),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},'"1h"')," - Hourly intervals"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},'"1d"')," - Daily intervals")),(0,r.kt)("h2",{id:"example-python-code"},"Example Python Code"),(0,r.kt)("p",null,"The below example shows how programmatically query for data."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'import requests\nimport json\n\nGRAPHQL_ENDPOINT = "https://api.srcful.dev/"\nGW_ID = "Your Gateway ID"  # Replace with your actual gateway ID\n\ndef fetch_battery_data():\n    """\n    Fetches battery data (latest and historical) from the backend API.\n    """\n    print("Fetching battery data...")\n\n    # Construct the GraphQL query\n    query = f"""\n    {{\n      derData {{\n        battery(gwId: "{GW_ID}") {{\n          latest {{\n            ts\n            power\n            soc\n          }}\n          historical(\n            start: "2025-04-01T00:00:00Z",\n            stop: "2025-04-03T23:59:59Z",\n            resolution: "15m"\n          ) {{\n            ts\n            power\n            soc\n          }}\n        }}\n      }}\n    }}\n    """\n\n    # Prepare the request payload\n    graphql_request_payload = {\n        "query": query\n    }\n\n    # Send the request to the backend\n    try:\n        print(f"Sending request to backend: {GRAPHQL_ENDPOINT}")\n        response = requests.post(\n            GRAPHQL_ENDPOINT,\n            json=graphql_request_payload,\n            headers={\'Content-Type\': \'application/json\'},\n            timeout=30 \n        )\n        response.raise_for_status() \n\n        # Print the response\n        print(f"Backend Status Code: {response.status_code}")\n        response_data = response.json()\n        print("Backend Response:")\n        print(json.dumps(response_data, indent=2))\n\n        # Check for GraphQL errors\n        if \'errors\' in response_data:\n            print("\\n--- GraphQL Errors ---")\n            for error in response_data[\'errors\']:\n                print(f"- {error.get(\'message\', \'Unknown error\')}")\n            print("----------------------")\n        elif \'data\' in response_data:\n            print("\\nBattery Data:")\n            print(json.dumps(response_data[\'data\'], indent=2))\n\n    except requests.exceptions.RequestException as e:\n        print(f"Error sending request to backend: {e}")\n    except json.JSONDecodeError:\n        print(f"Error decoding JSON response from backend: {response.text}")\n\n# --- Main Execution ---\nif __name__ == "__main__":\n    fetch_battery_data()\n')))}c.isMDXComponent=!0}}]);